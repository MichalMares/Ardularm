<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ardularm: Ardularm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="favicon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ardularm
   </div>
   <div id="projectbrief">Creating an Arduino-based alarm on a budget</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Ardularm </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Ardularm is a proof-of-concept project which focuses on making an inexpensive alarm based on the Arduino platform. <a href="https://github.com/MichalMares/Ardularm">GitHub Repository</a></p>
<h2>Components and Wiring</h2>
<p>Scheme:</p>
<div class="image">
<img src="wiring.png" alt="wiring.png"/>
<div class="caption">
Wiring</div></div>
<p> You can also view this scheme in the Fritzing programme (<code>Wiring.fzz</code>).</p>
<p>Used components:</p><ul>
<li>Arduino UNO Rev3</li>
<li>Ethernet Shield R3</li>
<li>RFID Reader RC522</li>
<li>Passive Infrared Sensor HC-SR501</li>
<li>Generic RGB Diode</li>
</ul>
<p>Other components might work as well (not tested).</p>
<h2>Installation</h2>
<p>Ardularm had been developed with Arduino IDE (for the Arduino code) and any other editor (for the server-side PHP code). Libraries <a href="http://www.addicore.com/v/vspfiles/downloadables/Product%20Downloadables/RFID_RC522/AddicoreRFID.zip">AddicoreRFID</a>* and <a href="http://getbootstrap.com/">Bootstrap framework</a> were used while creating this. To run this project on your own, there are a few steps necessary:</p>
<ol type="1">
<li>Create a database and an e-mail box on your hosting.</li>
<li>Fill in the settings file with the right credentials for your database in <code>Server\template.config.php</code> and save it as <code>Server\config.php</code>.</li>
<li>Create a <code>Server\.htpasswd</code> file with your desired user name and password (<a href="https://faq.oit.gatech.edu/content/how-do-i-do-basicauth-using-htaccess-and-htpasswd">https://faq.oit.gatech.edu/content/how-do-i-do-basicauth-using-htaccess-and-htpasswd</a>), edit path in <code>Server\template.htaccess</code> file and save it as <code>.htaccess</code>. ".htaccess" works for Apache servers only!</li>
<li>Upload the content of <code>Server</code> onto your server.</li>
<li>Run the <code>Server\<a class="el" href="create_8php.html" title="Creates necessary tables in database to run Ardularm. ">create.php</a></code> script. This will create all the tables needed for the project and necessary values.</li>
<li>Wire up your Arduino UNO according to "Components and Wiring" section of this document.</li>
<li>Fill in the variables in <code>Arduino\Ardularm\<a class="el" href="_ardularm_8ino.html" title="The code running on Arduino unit. ">Ardularm.ino</a></code> under the comment "user-configurable".</li>
<li>Upload <code>Arduino\Ardularm\<a class="el" href="_ardularm_8ino.html" title="The code running on Arduino unit. ">Ardularm.ino</a></code> on your Arduino UNO using the Arduino IDE.</li>
<li>Repeat steps 6, 7, 8 for each unit you want to connect.</li>
<li>Enjoy your extra safety.</li>
</ol>
<p>Ardularm had been developed running an Apache server with MySQL database. However, PDO should ensure it works on other SQL databases as well (not tested).</p>
<p>Arduino's (<code><a class="el" href="_ardularm_8ino.html" title="The code running on Arduino unit. ">Ardularm.ino</a></code>) and server's (<code>config.php</code>) "key" must correspond and can not be empty. It ensures that the POST requests come directly from the Arduino unit. If you use multiple Arduinos, "key" has to be the same for all of them.</p>
<ul>
<li>The AddicoreRFID library had to be edited in order to work with Ethernet shield.</li>
</ul>
<h2>How to use Ardularm?</h2>
<p><b>Turn alarm on/off</b> Trusted card has to be used to toggle the state. When the alarm is on the diode turns red, when off it is green (as a traffic light - green means you can enter).</p>
<p><b>Add/remove a card to/from trusted</b> First, MasterTag has to be detected and the diode turns blue. Then you can scan your card and it will be added as trusted, if it was not trusted befor. BEWARE: If your card already is trusted, it will be REMOVED.</p>
<p><b>Viewing the log</b> Log is located on the page <code>../dash.php</code>. Entries are sorted from newest to oldest. To search in between specific dates, enter them and click "search". If you want to leave the page running and see new entries without refreshing the page, just tick the "autorefresh" checkbox. This will refresh the page atomatically every 5 seconds.</p>
<div class="image">
<img src="log.jpg" alt="log.jpg"/>
<div class="caption">
Log</div></div>
<p> <b>Editing card name</b> Under the date selection on the log page, click the button "Change User Name". All four IDs must be filled in order to change the name. Successful change will be confirmed at the end of the paragraph.</p>
<div class="image">
<img src="user.jpg" alt="user.jpg"/>
<div class="caption">
User</div></div>
 <h2>Result</h2>
<p>When done correctly, final product should look something like this:</p>
<div class="image">
<img src="front.jpg" alt="front.jpg"/>
<div class="caption">
Front</div></div>
<div class="image">
<img src="back.jpg" alt="back.jpg"/>
<div class="caption">
Back</div></div>
<div class="image">
<img src="inside.jpg" alt="inside.jpg"/>
<div class="caption">
Inside</div></div>
<p> The PIR sensor should face the area you want to secure and RFID reader with LED should be accessable without entering it. Of course, wires can be lengthened and mechanically protected in order to achieve this result.</p>
<h2>For Developers</h2>
<p>Ardularm consists of three main parts. The first one is the code for Arduino unit (<code>Arduino\Ardularm\<a class="el" href="_ardularm_8ino.html" title="The code running on Arduino unit. ">Ardularm.ino</a></code>), which works just like any other Arduino sketch - there is a setup() method which runs once and loop() method, which cycles for the rest of the time, running the code and calling the other methods. Second are the API's, which take care of the communication between Arduino and the database (<code>Server\api\</code>). Last is the dashboard (<code>Server\<a class="el" href="dash_8php.html" title="Enables the user to see entries in database. ">dash.php</a></code>) which shows the log to the user and enables some basic sorting and changing the name of the cards (<code>Server\<a class="el" href="user_8php.html" title="Enables the user to change names associated with cards. ">user.php</a></code>).</p>
<p>In-depth documentation can be found in <code>Server\DoxyDoc\</code>.</p>
<p>Code posted here can be further developed. If you would like to make it work on a different Arduino board, change pin definitions at the beginning of <code>Arduino\Ardularm\Arduino.ino</code>. Mainly, SPI pins (which are pre-defined) must be changed and then connected accordingly. Buzzer extension is also possible: add a tone(pin, frequency) method into the <code>if (digitalRead(pirPin) == HIGH)</code> block of code and noTone() after it. <a href="https://www.arduino.cc/en/reference/tone">Documentation of tone()</a> To send a SMS alert instead of an email, you will need something like a GSM/GPRS Shield. Instead of calling <code>post("sendMail", "");</code> in <code>if (digitalRead(pirPin) == HIGH)</code> block, you will then use sms.print() method to send a SMS according to the <a href="https://www.arduino.cc/en/Tutorial/GSMExamplesSendSMS">official tutorial</a> on sending SMS.</p>
<h2>License</h2>
<p><a href="https://github.com/MichalMares/Ardularm/blob/master/LICENSE.txt">MIT</a> @ <a href="https://github.com/MichalMares">Michal Mare≈°</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
